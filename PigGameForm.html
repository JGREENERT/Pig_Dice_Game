<!DOCTYPE html>
<script src="PigGamePlayer.js"></script>
<script src="PigGameDice.js"></script>
<script src="PigGameEngine.js"></script>
<script src="PigGameControl.js"></script>
<script type="text/javascript">
    var set = false;
    var error = false;

    function validateInput(event) {
        event.preventDefault();
        if (!set) {
            var message = document.getElementById("Error").childNodes;

            /*Resetting Error Message*/
            if (error) {
                document.getElementById("Error").removeChild(message[0]);
            }

            /*Getting Form Values*/
            var NOP = document.getElementById("NOP").value;
            var PTW = document.getElementById("PTW").value;
            var NOD = document.getElementById("NOD").value;

            /*Input is not a Number*/
            if (isNaN(NOP) || isNaN(PTW) || isNaN(NOD)) {
                console.log("Not a Number");
                setErrorMessage("Please make sure all fields are a number");
            }
            /*Input is Negative*/
            else if (NOP < 0 || PTW < 0 || NOD < 0) {
                console.log("Is Negative");
                setErrorMessage("Please make sure all fields contain a Positive number");
            }

            /*Input is a Decimal*/
            else if (NOP % 1 != 0 || PTW % 1 != 0 || NOD % 1 != 0) {
                console.log("Is a Decimal");
                setErrorMessage("Please make sure all fields contain a Whole number");
            }

            else if(NOP == "" || PTW == "" || NOD == "")
            {
                console.log("Is empty");
                setErrorMessage("Please make sure all fields contain a value");
            }
            else {
                error = false;
                createInnerForm();
            }
        }
        else
            resetForm();

    };

    /*
    *   Sets the error message for a specified error
    */
    function setErrorMessage(message)
    {
        var NANPara = document.createElement("p");
        NANPara.setAttribute('style', "text-shadow: 2px 2px 4px #000000; font-size:x-large; text-align:center; color: red");
        var NANContent = document.createTextNode(message);
        NANPara.appendChild(NANContent);
        document.getElementById("Error").appendChild(NANPara);
        error = true;
    };

    /*
     *   Creates the form for user to insert player
     *   names and start the game.
     */
    var createInnerForm = function () {

        /*Setting up Player Name HTML*/
        var playerForm = document.createElement("form");
        var numOfPlayers = document.getElementById("NOP").value;
        for (var i = 0; i < numOfPlayers; i++) {
            var playerItem = document.createElement("input");
            playerItem.setAttribute('type', "text");
            playerItem.setAttribute('name', 'Player' + i + 'Name');
            playerItem.setAttribute('id', 'Player' + i);
            playerItem.setAttribute('value', 'Player' + i);
            playerForm.appendChild(playerItem);
        }
        /*Creating Player Name HTML and adding Play Button*/
        playerForm.appendChild(document.createElement("br"));
        var submitButton = document.createElement("input");
        submitButton.setAttribute('type', "submit");
        submitButton.setAttribute('name', "Play");
        submitButton.setAttribute('value', "Play");
        playerForm.appendChild(submitButton);
        document.getElementById("Inner Form").appendChild(playerForm);
        document.getElementById("Inner Form").addEventListener("submit", startGame);

        /*Changing set to reset event listener*/
        set = true;
        document.getElementById("submit").value = "Reset";
    };

    /*
     *   Resets the form if a user wants to make
     *   a different selection
     */
    var resetForm = function()
    {
        /*Resetting Outer Form Values for Reset*/
        document.getElementById("NOP").value = "";
        document.getElementById("PTW").value = "";
        document.getElementById("NOD").value = "";

        /*Removing the Player Name HTML*/
        var InnerForm = document.getElementById("Inner Form").childNodes;
        document.getElementById("Inner Form").removeChild(InnerForm[0]);

        /*Changing reset to set event listener*/
        set = false;
        document.getElementById("submit").value = "Set";
    };

    /*
     *   Starts the Game by calling the Pig Game View
     *   and creating the UI by manipulating the DOM
     */
    var startGame = function(event){
        event.preventDefault();

        var BodyHTML = document.body.childNodes;

        /*Removing "Info Form" HTML*/
        BodyHTML[4].style.display = 'none';

        /*Adding Game UI HTML*/
        BodyHTML[6].style.display = 'block';

        /*Starting Game*/
        //TODO: Start the Game
    };

</script>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<h3 style="font-size:xx-large; color: white; text-shadow: 2px 2px 4px #000000; text-align:center">Joe & Jesse's PigGame!</h3>
<body background="Images/Pig_Background.jpg">
<div id="Error"></div>
<div id="Info Forms">
    <fieldset style="border-style: solid; border-width:15px; border-color: hotpink; width: 25%; margin:auto;">
        <legend style="font-size: xx-large; color: White; text-shadow: 2px 2px 4px #000000; text-align: center"><b><i>Player Form</i></b></legend>
        <div id="Outer Form">
            <form style="width: 100%">
                <code style="font-size: x-large; color: White; text-shadow: 2px 2px 4px #000000;"><b>Number of Players</b></code>
                <input type="text" name="NOP" id="NOP" value="4"><br/>
                <code style="font-size: x-large; color: White; text-shadow: 2px 2px 4px #000000;"><b>Points to Win</b></code>
                <input type="text" name="PTW" id="PTW" value="100"><br/>
                <code style="font-size: x-large; color: White; text-shadow: 2px 2px 4px #000000;"><b>Number of Dice</b></code>
                <input type="text" name="NOD" id="NOD" value="2"><br/>
                <input type="submit" name="submit" id="submit" value="Set">
            </form><br/>
        </div>
        <div id="Inner Form"></div>
    </fieldset>
</div>
<div id="Game" style="display: none">
    <table>
        <tr>
            <td style="width:15%" valign="top">
                <div id="PlayersDiv">
                </div>
            </td>
            <td style="width:15%" valign="top">
                <button style="background-color:lightgreen" onmousedown=rollDiceButtonClicked()>Roll the dice!</button>
                <button style="background-color:lightgreen" onmousedown=endTurnButtonClicked()>End turn!</button>
                <button onmousedown=playGameAutomagicallyInterval()>Play Game Automagically</button>
                <button style="background-color:lightgreen" onmousedown=resetButtonClicked()>Reset Game!</button>
            </td>
            <td style="width:70%" valign="top">
                <div id="GameOutput">
                    Begin rolling dice!
                </div>

                <div id="Dice"></div>

                <div id="accumulatedValue">
                    Accumulated Value:
                </div>
            </td>
        </tr>
    </table>
</div>
</body>
</html>
<script type="text/javascript">
    document.getElementById("Outer Form").addEventListener("submit", validateInput);
</script>
